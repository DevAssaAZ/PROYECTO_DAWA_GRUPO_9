<form [formGroup]="form" class="ocultar" (submit)="onSubmit()">
    <mat-form-field class="formElement">
        <mat-label>Numero de Factura: </mat-label>
        <input matInput type="text" placeholder="numero de factura" formControlName="numeroFactura"/>
        <mat-error>
            @if(form.get('numeroFactura')?.invalid && (form.get("numeroFactura")?.dirty || form.get('numeroFactura')?.touched)){
                @if(form.get('numeroFactura')?.errors?.['required']){
                    El numero de Factura es requerido
                }@else if(form.get('numeroFactura')?.errors?.['minlength']){
                    Numero de factura  Minimo 3 caracteres

                }@else if(form.get('numeroFactura')?.errors?.['patterns']){
                    Solo letras y numeros
                    

                }
            }
        </mat-error>

    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Id del Cliente: </mat-label>
        <input matInput type="number" placeholder="0" formControlName="cliente_id"/>
    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Producto: </mat-label>
        <input matInput type="text" placeholder="Producto" formControlName="producto"/>
        <mat-error>
            @if(form.get('producto')?.invalid && (form.get("producto")?.dirty || form.get('producto')?.touched)){
                @if(form.get('producto')?.errors?.['required']){
                    Producto es requerido
                }@else if(form.get('producto')?.errors?.['minlength']){
                    Producto  Minimo 3 caracteres

                }@else if(form.get('producto')?.errors?.['patterns']){
                    Solo letras y numeros
                    

                }
            }
        </mat-error>

    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Fecha de Compra: </mat-label>
        <input matInput [matDatepicker]="picker1" type="text" placeholder="Fecha de Compra" formControlName="fechaCompra"/>
        <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Descripcion: </mat-label>
        <input matInput type="text" placeholder="descripcion" formControlName="descripcion"/>
        <mat-error>
            @if(form.get('descripcion')?.invalid && (form.get("descripcion")?.dirty || form.get('descripcion')?.touched)){
                @if(form.get('descripcion')?.errors?.['required']){
                    Descripcion es requerido
                }@else if(form.get('descripcion')?.errors?.['minlength']){
                    Descripcion  Minimo 3 caracteres

                }@else if(form.get('descripcion')?.errors?.['patterns']){
                    Solo letras y numeros
                    

                }
            }
        </mat-error>

    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Estado: </mat-label>
        <mat-select formControlName="estado">
            <mat-option value="">SELECCIONE...</mat-option>
            <mat-option value="Pendiente">PENDIENTE</mat-option>
            <mat-option value="En Revision">EN REVISION</mat-option>
            <mat-option value="Aceptado">ACEPTADO</mat-option>
            <mat-option value="Rechazado">RECHAZADO</mat-option>
        </mat-select>
    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Fecha de Registro: </mat-label>
        <input matInput [matDatepicker]="picker2" type="text" placeholder="Fecha de registro" formControlName="fechaRegistro"/>
        <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
    </mat-form-field>

    <mat-form-field class="formElement">
        <mat-label>Actualizacion: </mat-label>
        <input matInput [matDatepicker]="picker3" type="text" placeholder="Fecha de actualizacion" formControlName="ultimaActualizacion"/>
        <mat-datepicker-toggle matIconSuffix [for]="picker3"></mat-datepicker-toggle>
        <mat-datepicker #picker3></mat-datepicker>
    </mat-form-field>

    <div class="actions">
        <button mat-raised-button color="primary" type="submit">Guardar</button>
        <div class="separar"></div>
            <button mat-raised-button color="primary"  type="reset">Cancelar</button>
    </div>

</form>


<div class="search-container">
    <mat-form-field>
        <mat-label>Buscar: </mat-label>
        <input matInput type="search" placeholder="Numero de Factura o Estado" #searchInput 
        (keyup)="search(searchInput)"/>
    </mat-form-field>
    <button (click)="search(searchInput)" mat-raised-button color="primary">Buscar</button>
</div>

<table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="numeroFactura">
        <th mat-header-cell *matHeaderCellDef> Numero de Factura </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.numeroFactura}}</td>
    </ng-container>
    <ng-container matColumnDef="cliente_id">
        <th mat-header-cell *matHeaderCellDef> Id de Cliente </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.cliente_id}}</td>
    </ng-container>
    <ng-container matColumnDef="producto">
        <th mat-header-cell *matHeaderCellDef> Producto </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.producto}}</td>
    </ng-container>
    <ng-container matColumnDef="fechaCompra">
        <th mat-header-cell *matHeaderCellDef> Fecha de Compra </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.fechaCompra | date: 'dd/MM/yyyy'}}</td>
    </ng-container>
    <ng-container matColumnDef="descripcion">
        <th mat-header-cell *matHeaderCellDef> Descripcion </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.descripcion}}</td>
    </ng-container>
    <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef> Estado </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.estado}}</td>
    </ng-container>
    <ng-container matColumnDef="fechaRegistro">
        <th mat-header-cell *matHeaderCellDef> Fecha de Registro </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.fechaRegistro | date: 'dd/MM/yyyy'}}</td>
    </ng-container>
    <ng-container matColumnDef="ultimaActualizacion">
        <th mat-header-cell *matHeaderCellDef> Ultima Actualizacion </th>
        <td mat-cell *matCellDef="let garantia">{{garantia.ultimaActualizacion | date: 'dd/MM/yyyy'}}</td>
    </ng-container>
    <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Acciones </th>
        <td mat-cell *matCellDef="let pelicula">
            <button mat-raised-button color="accent" (click)="editar(pelicula)">Editar</button>
            <div class="separart">
            </div>
            <button mat-raised-button color="warn" (click)="eliminar(pelicula)">Eliminar</button>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="['numeroFactura','cliente_id','producto', 'fechaCompra','descripcion','estado','fechaRegistro','ultimaActualizacion','actions']"></tr>
    <tr mat-row *matRowDef="let row; columns:['numeroFactura','cliente_id','producto', 'fechaCompra','descripcion','estado','fechaRegistro','ultimaActualizacion','actions'];"></tr>
</table>
<mat-paginator [pageSizeOptions]="[5,7,20]" aria-label="select page" showFirstLastButtons>
</mat-paginator>